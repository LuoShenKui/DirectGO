# DirectGO 产品总结（MVP）

## 1. 产品定位

DirectGO 是一个 Chrome 插件，把“输入框”变成“意图路由器”：

- 用户像使用搜索引擎一样输入自然语言或“平台 + 关键词”
- 插件在后台判断用户意图（直达 / 站内搜索 / 不确定兜底）
- 尽可能直达目标页面（必要时尝试从平台搜索页直接打开首条结果）

它的目标不是替代搜索引擎，而是让“打开正确页面”的路径更短、更一致。

## 2. 用户体验（像搜索引擎一样用）

### 2.1 New Tab 搜索页（默认入口）

- 打开新标签页即可看到 DirectGO 搜索框（仿搜索引擎风格）
- 回车或点击“搜索”，直接触发路由
- 右上角“设置”按钮进入配置页

### 2.2 Omnibox（兼容入口）

- 地址栏输入 `dg + 空格`，继续可用
- 适合高级用户或不打开新标签页时快速触发

## 3. 核心能力

### 3.1 三段式路由（优先级从高到低）

1) URL 直达  
用户输入本身就是链接时直接打开（仅允许 https；本地开发允许 http://localhost 与 http://127.0.0.1）。

2) 唯一词（用户自定义关键词映射）  
例如 `reddit rust wasm` → 跳转到用户配置的模板 URL（支持 `{q}` 占位符）。

3) AI 意图判断（可选，取决于用户是否配置 API Key）  
根据输入判断：
- direct：直达某站点/页面
- search：站内搜索页
- unknown：不确定则兜底

### 3.2 大平台搜索页首条直达（可开关）

当 AI 或“唯一词模板”得到的是某个平台的“搜索结果页”，并且该平台在白名单中时，插件会尝试从搜索结果页进一步解析并打开“首条结果”，减少一次点击。

当前支持的平台（白名单可配置）：
- B 站、Reddit、YouTube、TikTok、抖音、小红书、X

### 3.3 搜索词优化（偏理解意图）

当识别到“平台内搜索”语句时，会尝试从句子中抽取更核心的检索词（中英文均支持），提升首条直达的命中率：

- 中文例：`B站 影视飓风的最新视频` → 更偏向抽取“影视飓风”
- 英文例：`latest video of MrBeast` → 抽取“MrBeast”

### 3.4 B 站“前 5 条候选重排”

对于“某人最新视频/最近投稿”这类常见表达，B 站默认搜索的第一条可能是“别人的视频里提到了 X”。

DirectGO 采用更稳的策略：
- 拉取默认搜索结果前 5 条
- 结合作者名/标题相关性做重排，优先选出更符合“属于关系”的结果

## 4. 安全与隐私策略（MVP 但不裸奔）

### 4.1 API Key 存储

- API Key 存储在 `chrome.storage.local`（不随账号同步）
- 其它设置存储在 `chrome.storage.sync`（可同步）

### 4.2 仅允许安全协议跳转

为了降低被模型诱导到不安全站点的风险：

- 只允许打开 `https://` 链接
- `http://` 链接默认不打开，直接走兜底搜索
- 例外：允许 `http://localhost/...` 与 `http://127.0.0.1/...`（开发场景）

### 4.3 失败即兜底

- 任何 AI 请求失败、解析失败、平台反爬、超时，都会回退到 Google/Bing 搜索结果页
- 兜底始终使用用户原始输入，不受“搜索词优化”影响

## 5. 配置项（设置页）

- API Endpoint / Model：可接 DeepSeek / OpenAI 兼容接口等
- API Key：本地保存
- 唯一词：`keyword=url`，支持 `{q}`
- 唯一词命中时强制跳转：只输入关键词时直接打开模板
- 大平台首条直达开关：是否尝试从平台搜索页直接打开首条结果
- 首条直达白名单域名：每行一个域名，可增删
- 兜底搜索引擎：Google / Bing

## 6. 技术架构概览

- MV3 Service Worker：`background.js` 负责路由、AI 调用、首条解析、兜底策略
- New Tab UI：`newtab.html / newtab.js` 负责“像搜索引擎一样”的输入体验
- Options：`options.html / options.js` 负责配置存储与管理
- Manifest：`manifest.json` 配置权限、options 与 newtab 覆盖

## 7. 已知限制（MVP 取舍）

- 部分平台搜索页结构变动/反爬会导致“首条直达”失败（会自动兜底）
- X/YouTube 等强动态站点不保证能稳定抓到首条内容
- 目前不做“AI 对 10 条候选重排”的通用方案（成本与耗时波动较大）

## 8. 后续可迭代方向（按收益排序）

- 首条直达更精细的“意图类型”开关（例如：只对 B 站/Reddit 开启）
- “候选重排”统一抽象：候选列表 + 规则/模型重排 + 安全过滤
- UI 增加历史记录、快捷书签、最近搜索
- 新增可配置的“安全模式”：严格 https / 允许 http / 仅允许白名单域名

